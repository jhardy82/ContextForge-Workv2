# WU Scan Source & Co-Management – Workspace Context (Agent Answers)

Generated: 2025-08-12T00:00:00Z
Author: GitHub Copilot Agent (workspace assessment)

---

## Workspace Configuration & Structure

### Structure highlights

- Root folders:
  - .github/, .vscode/, AAR/, analysis/, archive/, backup/
  - build/, config/, data/, db/, docs/, examples/
  - githooks/, handoff/, logs/, Outputs/, samples/
  - SCCM/, scripts/, src/, temp/, tests/, tools/
- WU script and related:
  - SCCM/ (Get-WUScanSource.ps1)
  - tests/ (four WU-specific test files)
  - build/ (Run-WUScanSourceTests.ps1, PSSA, CI helpers)
  - docs/context/ (context documents)

### Script location

- SCCM/Get-WUScanSource.ps1

### Related modules, helpers, and config

- build/Invoke-PSSA.ps1 (PSScriptAnalyzer wrapper)
- build/PSSA.Settings.psd1 (enterprise analyzer ruleset)
- build/Run-WUScanSourceTests.ps1 (focused Pester runner for WU tests)
- build/Bootstrap-Quality.ps1, Run-PesterTests.ps1, Run-QualitySuite.ps1
 (quality orchestration)
- build/Logging-Common.ps1 (shared logging helpers)
- tests/TestHelpers.psm1 (Pester helpers)
- .vscode/tasks.json (VS Code tasks for quality/test runs)

### Test data, mocks, and sample outputs

- tests/mocks/, tests/integration/, tests/performance/ (test scaffolding)
- build/artifacts/ (test outputs and analysis artifacts; created at runtime)
- logs/, Outputs/ (runtime outputs)

### CI/CD configuration presence

- GitHub Actions workflow present: .github/workflows/quality-wu.yml (runs PSScriptAnalyzer
 and focused WU tests on windows-latest; uploads artifacts).
- VS Code tasks.json provides local automation for builds, analysis, and tests.

---

## Tools, Extensions & Environment

### Tools and language servers (observable)

- PowerShell development via VS Code (.vscode/ present); Pester used via scripts.
- PSScriptAnalyzer invoked by build/Invoke-PSSA.ps1 and configured by PSSA.Settings.psd1.
- Pre-commit/push hooks in githooks/ (PowerShell).
- Note: Extension list isn’t stored in repo; PowerShell extension assumed installed for
 language features. Assumption.

### PowerShell versions

- Target explicitly PowerShell 5.1 (#requires in tests/runners). Windows default shell is
 Windows PowerShell 5.1 per environment info.

### PSScriptAnalyzer availability and custom rules

- build/Invoke-PSSA.ps1 imports PSScriptAnalyzer and uses build/PSSA.Settings.psd1 which
 enforces zero-warning policy and PS5.1 compatibility rules.

### Testing frameworks

- Pester 5.7.x enforced by build/Run-WUScanSourceTests.ps1 and tasks.json (Quality: Tests;
 WU: Focused Tests).
- No other testing frameworks detected in repo.

### Markdown and documentation tooling

- Markdown lint config: .markdownlint.json
- Extensive docs in docs/; Communication-to-ChatGPT*.md/.yaml handoffs in root.

---

## Existing Assets & Resources

### Existing mock and evidence data

- tests/ include WU mock scenarios and evidence validations (e.g.,
  SCCM.Get-WUScanSource.Evidence.Tests.ps1). Evidence bundles are generated to temp or
  build/artifacts at runtime.

### Test cases relevant to the WU script

- tests/SCCM.Get-WUScanSource.Tests.ps1 (smoke)
- tests/SCCM.Get-WUScanSource.MockScenarios.Tests.ps1
- tests/SCCM.Get-WUScanSource.ValueTranslation.Tests.ps1
- tests/SCCM.Get-WUScanSource.Evidence.Tests.ps1
- build/Run-WUScanSourceTests.ps1 orchestrates these four.

### Value translation tables

- Implemented within SCCM/Get-WUScanSource.ps1 (translations for AUOptions,
  DetectionFrequency, BranchReadiness); validated by ValueTranslation tests.

### Documentation describing intended behavior

- docs/context/wu_scan_source_context_20250812.md (design context)
- Communication-to-ChatGPT-*.md/.yaml files summarizing requirements, goals, and progress
- SCCM/README* files for related SCCM scripts

---

## Automation & Integration

### Automation interacting with the WU script

- build/Run-WUScanSourceTests.ps1 runs the focused test suite for the script.
- .vscode/tasks.json includes “WU: Focused Tests” to trigger a CI-style run locally.

### CI/CD inclusion

- GitHub Actions is configured via .github/workflows/quality-wu.yml to run PSScriptAnalyzer
  and the focused WU tests and upload artifacts on push/PR.
- Local CI via VS Code tasks and build scripts also produces NUnit XML under build/artifacts.

### Pre-commit and lint hooks

- githooks/pre-commit.ps1 and githooks/pre-push.ps1 present (PowerShell). Content not
 reviewed here; assumed to run PSSA/tests or similar. Assumption.

### Evidence bundle and test output automation

- Evidence bundles generated by the script when -ExportEvidenceDir is provided (validated by
 tests). Test runner emits NUnit XML (build/artifacts/TestResults.WUScanSource.xml) when -CI.

---

## Workspace Constraints & Assumptions

### Limitations

- No live SCCM/Intune connectivity in repo; tests rely on mocks.
- PowerShell 5.1 runtime expected; modules like Pester/PSScriptAnalyzer must be installed on
 the machine (scripts attempt to import and will error if missing).

### Workspace-specific settings affecting runs

- .vscode/tasks.json sets execution via PowerShell with ExecutionPolicy Bypass; environment
 flag WUScanSource_SkipMain used in tests to prevent auto-run.
- PSSA settings enforce strict rules; may cause CI to fail if warnings exist.

### Online/offline status

- Repository itself is offline-capable; tests use mocks and local evidence dirs. Some scripts
 (e.g., installing modules) require internet if modules are not present. Overall: mixed;
 offline-friendly once modules are installed.

---

Appendix: Quick pointers

- Script: SCCM/Get-WUScanSource.ps1
- Focused tests: build/Run-WUScanSourceTests.ps1 or VS Code task “WU: Focused Tests”
- Analyzer: build/Invoke-PSSA.ps1 with build/PSSA.Settings.psd1
- Artifacts: build/artifacts/ (created during runs)
- Context docs: docs/context/
