# TaskMan-v2 Backend API - Production Configuration Template
# This file provides a template for production environment variables.
# Copy this file to .env.production and update with actual production values.
#
# ⚠️  CRITICAL SECURITY WARNINGS ⚠️
# - NEVER commit .env.production to version control!
# - NEVER use default or example values in production!
# - NEVER include "test", "dev", "example", or "CHANGE_ME" in production secrets!
# - ALWAYS use AWS Secrets Manager or similar for production secrets!
#
# Production Deployment Checklist:
# ✅ Generate unique 32+ character secrets
# ✅ Use strong database passwords (20+ chars, mixed case, numbers, symbols)
# ✅ Enable SSL/TLS for database connections
# ✅ Configure AWS Secrets Manager integration
# ✅ Set up monitoring and alerting
# ✅ Enable Redis for production caching
# ✅ Review and test configuration before deployment

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Application name
APP_APP_NAME=TaskMan API

# Deployment environment (MUST be "production")
APP_ENVIRONMENT=production

# ============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# ============================================================================

# Production database host (use RDS endpoint or container name)
# Example: taskman-prod.c9akx1234567.us-east-1.rds.amazonaws.com
APP_DATABASE__HOST=CHANGE_ME_production_db_host

# Database port (default: 5432)
APP_DATABASE__PORT=5432

# Database username
# Example: taskman_prod
APP_DATABASE__USER=CHANGE_ME_production_db_user

# Database password
# ⚠️  CRITICAL: Generate a strong password (20+ characters)
# Example generation:
#   python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# IMPORTANT: In production, load this from AWS Secrets Manager!
# See config.py for AWS Secrets Manager integration pattern.
APP_DATABASE__PASSWORD=CHANGE_ME_production_db_password

# Database name
APP_DATABASE__DATABASE=taskman_production

# Enable SQL query logging (DISABLE in production for performance!)
# Only enable temporarily for debugging production issues
APP_DATABASE__ECHO_SQL=false

# Database connection pool size (number of persistent connections)
# Production recommendation: 20-50 (depends on expected concurrent requests)
# Start with 20 and scale up based on monitoring
# Range: 1-100
APP_DATABASE__POOL_SIZE=20

# Maximum overflow connections beyond pool_size
# These are temporary connections created when pool is exhausted
# Production recommendation: 10-20
# Range: 0-50
APP_DATABASE__MAX_OVERFLOW=10

# ============================================================================
# REDIS CONFIGURATION (Required for Production)
# ============================================================================

# Production Redis URL (use ElastiCache endpoint or container name)
# Example: redis://taskman-prod.abc123.0001.use1.cache.amazonaws.com:6379
APP_REDIS__URL=redis://CHANGE_ME_production_redis_host:6379

# Redis connection timeout in seconds (recommend 10 for production)
APP_REDIS__TIMEOUT=10

# Redis database number (0-15, recommend 0 for production)
APP_REDIS__DB=0

# ============================================================================
# SECURITY & AUTHENTICATION
# ============================================================================

# Application secret key (minimum 32 characters)
# ⚠️  CRITICAL: Generate a cryptographically secure key
#
# Generate with:
#   python -c "import secrets; print(secrets.token_urlsafe(48))"
#
# IMPORTANT: In production, load this from AWS Secrets Manager!
# The config.py validator will REJECT any key containing:
# - "CHANGE_ME"
# - "INSECURE"
# - "test"
# - "dev"
# - "your-secret"
#
APP_SECRET_KEY=CHANGE_ME_GENERATE_UNIQUE_SECRET_KEY_MIN_32_CHARS

# JWT signing secret (minimum 32 characters)
# ⚠️  CRITICAL: MUST be different from APP_SECRET_KEY
#
# Generate with:
#   python -c "import secrets; print(secrets.token_urlsafe(48))"
#
# IMPORTANT: In production, load this from AWS Secrets Manager!
APP_JWT_SECRET=CHANGE_ME_GENERATE_UNIQUE_JWT_SECRET_MIN_32_CHARS

# ============================================================================
# AWS SECRETS MANAGER INTEGRATION (Recommended)
# ============================================================================

# To use AWS Secrets Manager in production, configure these environment variables:
#
# AWS_REGION=us-east-1
# AWS_SECRET_NAME=taskman/production
#
# Then store your secrets in AWS Secrets Manager as JSON:
# {
#   "database_password": "actual_secure_password",
#   "secret_key": "actual_secure_secret_key",
#   "jwt_secret": "actual_secure_jwt_secret"
# }
#
# The config.py module will automatically load secrets from AWS when:
# - APP_ENVIRONMENT=production
# - AWS_REGION and AWS_SECRET_NAME are set
#
# See config.py documentation for implementation details.

# ============================================================================
# PRODUCTION DEPLOYMENT STEPS
# ============================================================================

# 1. Create AWS Secrets Manager secret:
#    aws secretsmanager create-secret \
#      --name taskman/production \
#      --secret-string '{"database_password":"...","secret_key":"...","jwt_secret":"..."}'
#
# 2. Grant IAM permissions to application:
#    {
#      "Effect": "Allow",
#      "Action": ["secretsmanager:GetSecretValue"],
#      "Resource": "arn:aws:secretsmanager:us-east-1:*:secret:taskman/production-*"
#    }
#
# 3. Set environment variables in deployment:
#    APP_ENVIRONMENT=production
#    APP_DATABASE__HOST=production-db-host
#    APP_DATABASE__USER=production_user
#    APP_DATABASE__DATABASE=taskman_production
#    APP_REDIS__URL=redis://production-redis-host:6379
#    AWS_REGION=us-east-1
#    AWS_SECRET_NAME=taskman/production
#
# 4. Deploy application with environment variables
#
# 5. Verify configuration on startup:
#    - Check logs for "✅ Configuration valid (production)"
#    - Check logs for "✅ Database connection verified"
#    - Ensure no "CHANGE_ME" or default values in logs

# ============================================================================
# PRODUCTION SECURITY BEST PRACTICES
# ============================================================================

# Database:
# ✅ Enable SSL/TLS connections (require sslmode=require)
# ✅ Use IAM authentication for RDS if possible
# ✅ Rotate database password every 90 days
# ✅ Use least-privilege database user (no CREATE/DROP permissions)
# ✅ Enable automated backups with point-in-time recovery

# Secrets:
# ✅ Store ALL secrets in AWS Secrets Manager
# ✅ Enable automatic secret rotation
# ✅ Never log or expose secrets in API responses
# ✅ Use different secrets for each environment
# ✅ Audit secret access with CloudTrail

# Infrastructure:
# ✅ Use private subnets for database and Redis
# ✅ Enable VPC flow logs for network monitoring
# ✅ Configure security groups with least privilege
# ✅ Enable at-rest encryption for RDS and ElastiCache
# ✅ Enable in-transit encryption for all connections

# Monitoring:
# ✅ Set up CloudWatch alarms for API errors
# ✅ Monitor database connection pool metrics
# ✅ Track secret access patterns
# ✅ Alert on configuration validation failures
# ✅ Monitor Redis cache hit/miss ratios

# ============================================================================
# ROLLBACK PROCEDURE
# ============================================================================

# If configuration issues are detected in production:
#
# 1. Immediately revert to last known good configuration
# 2. Check CloudWatch logs for validation errors
# 3. Verify AWS Secrets Manager secret values
# 4. Test configuration in staging environment first
# 5. Document incident and update runbook

# Emergency Contacts:
# - On-Call Engineer: [Update with contact info]
# - Database Admin: [Update with contact info]
# - Security Team: [Update with contact info]
